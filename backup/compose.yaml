services:
  redis-server:
    image: redis:7.2.4
    environment: 
      - REDIS_ARGS=--save 30 1
    ports:
      - 6379:6379
    volumes:
      - ./data:/data
    #volumes:
    #  - redis-data:/data

  webapp:
    build: .
    ports:
      - 8080:8080 
    environment:
      - MESSAGE=🎉 Hello from 🐳 Compose 👋
      - TITLE=My favorite restaurants
      - REDIS_URL=redis-server:6379    
    depends_on:
      - redis-server 
    develop:
      watch:
        - action: sync
          path: ./public
          target: /app/public
        - action: rebuild
          path: ./Dockerfile
        - action: rebuild
          path: ./main.go
#volumes:
#  redis-data: